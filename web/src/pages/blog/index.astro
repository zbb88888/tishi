---
/**
 * /blog â€” åšå®¢æ–‡ç« åˆ—è¡¨
 *
 * æ•°æ®æºï¼šdata/posts/*.jsonï¼ˆå·²å‘å¸ƒæ–‡ç« ï¼‰
 */
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getPublishedPosts } from '../../lib/data';

const posts = getPublishedPosts();

function formatDate(dateStr: string | undefined): string {
  if (!dateStr) return '';
  return new Date(dateStr).toLocaleDateString('zh-CN', {
    year: 'numeric', month: 'long', day: 'numeric',
  });
}

function typeLabel(type: string): string {
  const labels: Record<string, string> = {
    weekly: 'ğŸ“Š å‘¨æŠ¥',
    monthly: 'ğŸ“ˆ æœˆæŠ¥',
    spotlight: 'ğŸ”¦ æ·±åº¦åˆ†æ',
  };
  return labels[type] || type;
}
---

<BaseLayout title="åšå®¢">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900">ğŸ“ åšå®¢</h1>
    <p class="mt-2 text-gray-600">AI å¼€æºè¶‹åŠ¿å‘¨æŠ¥ã€æœˆæŠ¥ä¸æ·±åº¦åˆ†æ</p>
  </div>

  {posts.length === 0 ? (
    <div class="card text-center text-gray-500 py-12">
      <p>æš‚æ— æ–‡ç« </p>
      <p class="mt-2 text-sm">
        è¿è¡Œ <code class="bg-gray-100 px-2 py-1 rounded">tishi generate</code> ç”Ÿæˆé¦–ç¯‡æ–‡ç« 
      </p>
    </div>
  ) : (
    <div class="space-y-4">
      {posts.map(post => (
        <a href={`/blog/${post.slug}`} class="card block group">
          <div class="flex items-start justify-between">
            <div>
              <span class="text-xs text-gray-400">{typeLabel(post.post_type)}</span>
              <h2 class="mt-1 text-lg font-semibold text-gray-900 group-hover:text-primary-600 transition-colors">
                {post.title}
              </h2>
            </div>
            <time class="shrink-0 text-xs text-gray-400 ml-4">
              {formatDate(post.published_at)}
            </time>
          </div>
        </a>
      ))}
    </div>
  )}
</BaseLayout>
