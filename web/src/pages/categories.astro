---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCategories, type Category } from '../lib/api';

let categories: Category[] = [];
let error: string | null = null;

try {
  const res = await getCategories();
  categories = res.data;
} catch (e) {
  error = 'æš‚æ—¶æ— æ³•åŠ è½½åˆ†ç±»æ•°æ®';
}
---

<BaseLayout title="åˆ†ç±»">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900">ğŸ“‚ é¡¹ç›®åˆ†ç±»</h1>
    <p class="mt-2 text-gray-600">æŒ‰ AI å­é¢†åŸŸæµè§ˆçƒ­é—¨å¼€æºé¡¹ç›®</p>
  </div>

  {error ? (
    <div class="card text-center text-gray-500 py-12">
      <p>{error}</p>
    </div>
  ) : (
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {categories.map((cat) => (
        <div class="card">
          <h3 class="text-lg font-semibold text-gray-900">{cat.name}</h3>
          {cat.description && (
            <p class="mt-1 text-sm text-gray-500">{cat.description}</p>
          )}
          <div class="mt-4 flex items-center justify-between">
            <span class="badge-blue">{cat.project_count} ä¸ªé¡¹ç›®</span>
            <span class="text-xs text-gray-400">{cat.slug}</span>
          </div>
        </div>
      ))}
    </div>
  )}
</BaseLayout>
